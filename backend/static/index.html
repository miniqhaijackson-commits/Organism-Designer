<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>J.A.R.V.I.S Prototype UI</title>
    <style>
      body { background:#071023; color:#bfe6ff; font-family: sans-serif; padding:20px }
      .card { background:#0b2140; padding:12px; border-radius:8px; margin-bottom:12px }
      input, button, textarea { font-size:14px }
    </style>
  </head>
  <body>
    <h1>J.A.R.V.I.S (Prototype)</h1>

    <div style="display:flex;gap:8px;margin-bottom:12px">
      <a href="/ui/login.html" style="color:#9fe;">Admin Login</a>
      <a href="/ui/logs.html" style="color:#9fe;">View Audit Logs</a>
      <a href="/ui/sessions.html" style="color:#9fe;">Manage Sessions</a>
      <a href="/ui/session_audit.html" style="color:#9fe;">Revocation Audit</a>
      <a href="/ui/session_history.html" style="color:#9fe;">Session History</a>
      <a href="/ui/users.html" style="color:#9fe;">Manage Users</a>
      <a href="/ui/metrics.html" style="color:#9fe;">Metrics</a>
    </div>

    <div class="card">
      <h3>Create Project</h3>
      <input id="title" placeholder="Project title" />
      <input id="desc" placeholder="short description" />
      <button onclick="createProject()">Create</button>
    </div>

    <div class="card">
      <h3>Projects</h3>
      <button onclick="listProjects()">Refresh</button>
      <ul id="projects"></ul>
    </div>

    <div class="card">
      <h3>Send Command</h3>
      <textarea id="cmd" rows="3" cols="60" placeholder="Type a command"></textarea><br>
      <input id="pair" placeholder="Pair token (optional)" />
      <button onclick="sendCmd()">Send</button>
      <pre id="cmdres"></pre>
    </div>

    <script>
      async function createProject(){
        const title = document.getElementById('title').value
        const desc = document.getElementById('desc').value
        const res = await fetch('/projects', {method:'POST', headers:{'content-type':'application/json'}, body:JSON.stringify({title,description:desc})})
        const j = await res.json()
        console.log(j)
        listProjects()
      }

      async function listProjects(){
        const res = await fetch('/projects')
        const arr = await res.json()
        const ul = document.getElementById('projects')
        ul.innerHTML = ''
        arr.forEach(p=>{
          const li = document.createElement('li')
          li.textContent = `${p.id}: ${p.title} â€” ${p.description||''}`
          ul.appendChild(li)
        })
      }

      async function sendCmd(){
        const cmd = document.getElementById('cmd').value
        const token = document.getElementById('pair').value
        const headers = {'content-type':'application/json'}
        if(token) headers['x-pairing-token'] = token
        const res = await fetch('/commands', {method:'POST', headers, body:JSON.stringify({command_text:cmd})})
        const j = await res.json()
        document.getElementById('cmdres').textContent = JSON.stringify(j, null, 2)
      }

      // auto load projects
      listProjects()
    </script>
  </body>
</html>
